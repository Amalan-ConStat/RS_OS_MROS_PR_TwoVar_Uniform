---
title: "Articles_Plots"
author: "Amalan"
date: '`r format(Sys.Date(), "%B %d, %Y")`'
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,fig.width = 14,fig.height = 16,message = FALSE,warning = FALSE)
library(here)
library(ggplot2)
library(dplyr)
library(tidyr)
library(LaplacesDemon)
library(xtable)
library(flextable)
library(grid)
library(cowplot)
library(linguisticsdown)
library(ggpubr)

```

# Using Exponential Distribution for Data

```{r Load data model 1}
# Random Sampling
load(here("Non_Identical_r0","Summary","Classical","Model_1","Data","Efficiency","No_Correlated_Covariate_RS.RData"))

Old_Labels<-c("Real Model",paste0("Assumed Model ",1:3))
New_Labels<-c("RM",paste0("AM ",1:3))

for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
}

RS_Info<-All_Info
RS_MSE<-All_MSE

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR)

# OSMAC
load(here("Identical_r0","Summary","Classical","Model_1","Data","Efficiency","No_Correlated_Covariate_OSMAC.RData"))
remove_stuff<-c(paste0("Assumed New ",1:3))
All_MSE<-All_MSE[!(All_MSE$Model %in% remove_stuff),]
All_Info<-All_Info[!(All_Info$Model %in% remove_stuff),]

Old_Labels<-c("Real",paste0("Assumed Old ",1:3),"Model Free")
New_Labels<-c("RM",paste0("AM ",1:3),"MF")

## mMSE
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mMSE"] <-paste0("OSMAC mMSE ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mMSE"] <-paste0("OSMAC mMSE ",New_Labels[i])
}

## mVc
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mVc"] <-paste0("OSMAC mVc ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mVc"] <-paste0("OSMAC mVc ",New_Labels[i])
}

OSMAC_Info<-All_Info
OSMAC_MSE<-All_MSE

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR)

# All elements
All_MSE<-rbind(RS_MSE,OSMAC_MSE[,!(colnames(OSMAC_MSE) %in% "Type")])
All_Info<-rbind(RS_Info,OSMAC_Info[,!(colnames(OSMAC_Info) %in% "Type")])

All_Objects<-ls()
remove(list = All_Objects[startsWith(All_Objects,"OSMAC")])
remove("RS_Info","RS_MSE")

colnames(All_Info)[3]<-"Estimated Values"
colnames(All_MSE)[3]<-"Estimated Values"

M1_Identical_r0<-rbind(cbind.data.frame(Covariate="X1, X2",Metric="Model Information",All_Info),
                       cbind.data.frame(Covariate="X1, X2",Metric="MSE",All_MSE))

remove(All_Info,All_MSE,RS_Info,RS_MSE)
```

```{r Load data model 2}
# Random Sampling
load(here("Non_Identical_r0","Summary","Classical","Model_2","Data","Efficiency","No_Correlated_Covariate_RS.RData"))

Old_Labels<-c("Real Model",paste0("Assumed Model ",1:3))
New_Labels<-c("RM",paste0("AM ",1:3))

for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
}

RS_Info<-All_Info
RS_MSE<-All_MSE

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR)

# OSMAC
load(here("Identical_r0","Summary","Classical","Model_2","Data","Efficiency","No_Correlated_Covariate_OSMAC.RData"))
remove_stuff<-c(paste0("Assumed New ",1:3))
All_MSE<-All_MSE[!(All_MSE$Model %in% remove_stuff),]
All_Info<-All_Info[!(All_Info$Model %in% remove_stuff),]

Old_Labels<-c("Real",paste0("Assumed Old ",1:3),"Model Free")
New_Labels<-c("RM",paste0("AM ",1:3),"MF")

## mMSE
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mMSE"] <-paste0("OSMAC mMSE ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mMSE"] <-paste0("OSMAC mMSE ",New_Labels[i])
}

## mVc
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mVc"] <-paste0("OSMAC mVc ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mVc"] <-paste0("OSMAC mVc ",New_Labels[i])
}

OSMAC_Info<-All_Info
OSMAC_MSE<-All_MSE

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR)

# All elements
All_MSE<-rbind(RS_MSE,OSMAC_MSE[,!(colnames(OSMAC_MSE) %in% "Type")])
All_Info<-rbind(RS_Info,OSMAC_Info[,!(colnames(OSMAC_Info) %in% "Type")])

All_Objects<-ls()
remove(list = All_Objects[startsWith(All_Objects,"OSMAC")])
remove("RS_Info","RS_MSE")

colnames(All_Info)[3]<-"Estimated Values"
colnames(All_MSE)[3]<-"Estimated Values"

M2_Identical_r0<-rbind(cbind.data.frame(Covariate="X1, X2, X1\u00B2",Metric="Model Information",All_Info),
                       cbind.data.frame(Covariate="X1, X2, X1\u00B2",Metric="MSE",All_MSE))

remove(All_Info,All_MSE,RS_Info,RS_MSE)
```

```{r Load data model 3}
# Random Sampling
load(here("Non_Identical_r0","Summary","Classical","Model_3","Data","Efficiency","No_Correlated_Covariate_RS.RData"))

Old_Labels<-c("Real Model",paste0("Assumed Model ",1:3))
New_Labels<-c("RM",paste0("AM ",1:3))

for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
}

RS_Info<-All_Info
RS_MSE<-All_MSE

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR)

# OSMAC
load(here("Identical_r0","Summary","Classical","Model_3","Data","Efficiency","No_Correlated_Covariate_OSMAC.RData"))
remove_stuff<-c(paste0("Assumed New ",1:3))
All_MSE<-All_MSE[!(All_MSE$Model %in% remove_stuff),]
All_Info<-All_Info[!(All_Info$Model %in% remove_stuff),]

Old_Labels<-c("Real",paste0("Assumed Old ",1:3),"Model Free")
New_Labels<-c("RM",paste0("AM ",1:3),"MF")

## mMSE
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mMSE"] <-paste0("OSMAC mMSE ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mMSE"] <-paste0("OSMAC mMSE ",New_Labels[i])
}

## mVc
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mVc"] <-paste0("OSMAC mVc ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mVc"] <-paste0("OSMAC mVc ",New_Labels[i])
}

OSMAC_Info<-All_Info
OSMAC_MSE<-All_MSE

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR)

# All elements
All_MSE<-rbind(RS_MSE,OSMAC_MSE[,!(colnames(OSMAC_MSE) %in% "Type")])
All_Info<-rbind(RS_Info,OSMAC_Info[,!(colnames(OSMAC_Info) %in% "Type")])

All_Objects<-ls()
remove(list = All_Objects[startsWith(All_Objects,"OSMAC")])
remove("RS_Info","RS_MSE")

colnames(All_Info)[3]<-"Estimated Values"
colnames(All_MSE)[3]<-"Estimated Values"

M3_Identical_r0<-rbind(cbind.data.frame(Covariate="X1, X2, X2\u00B2",Metric="Model Information",All_Info),
                       cbind.data.frame(Covariate="X1, X2, X2\u00B2",Metric="MSE",All_MSE))

remove(All_Info,All_MSE,RS_Info,RS_MSE)
```

```{r Load data model 4}
# Random Sampling
load(here("Non_Identical_r0","Summary","Classical","Model_4","Data","Efficiency","No_Correlated_Covariate_RS.RData"))

Old_Labels<-c("Real Model",paste0("Assumed Model ",1:3))
New_Labels<-c("RM",paste0("AM ",1:3))

for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
}

RS_Info<-All_Info
RS_MSE<-All_MSE

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR)

# OSMAC
load(here("Identical_r0","Summary","Classical","Model_4","Data","Efficiency","No_Correlated_Covariate_OSMAC.RData"))
remove_stuff<-c(paste0("Assumed New ",1:3))
All_MSE<-All_MSE[!(All_MSE$Model %in% remove_stuff),]
All_Info<-All_Info[!(All_Info$Model %in% remove_stuff),]

Old_Labels<-c("Real",paste0("Assumed Old ",1:3),"Model Free")
New_Labels<-c("RM",paste0("AM ",1:3),"MF")

## mMSE
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mMSE"] <-paste0("OSMAC mMSE ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mMSE"] <-paste0("OSMAC mMSE ",New_Labels[i])
}

## mVc
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mVc"] <-paste0("OSMAC mVc ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mVc"] <-paste0("OSMAC mVc ",New_Labels[i])
}

OSMAC_Info<-All_Info
OSMAC_MSE<-All_MSE

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR)

# All elements
All_MSE<-rbind(RS_MSE,OSMAC_MSE[,!(colnames(OSMAC_MSE) %in% "Type")])
All_Info<-rbind(RS_Info,OSMAC_Info[,!(colnames(OSMAC_Info) %in% "Type")])

All_Objects<-ls()
remove(list = All_Objects[startsWith(All_Objects,"OSMAC")])
remove("RS_Info","RS_MSE")

colnames(All_Info)[3]<-"Estimated Values"
colnames(All_MSE)[3]<-"Estimated Values"

M4_Identical_r0<-rbind(cbind.data.frame(Covariate="X1, X2, X1\u00B2, X2\u00B2",Metric="Model Information",All_Info),
                       cbind.data.frame(Covariate="X1, X2, X1\u00B2, X2\u00B2",Metric="MSE",All_MSE))

remove(All_Info,All_MSE,RS_Info,RS_MSE)
```

```{r combine data and plot,fig.width = 18,fig.height = 10}
Identical_ro<-rbind(M1_Identical_r0,M2_Identical_r0,
                    M3_Identical_r0,M4_Identical_r0)

Identical_ro$Covariate<-factor(Identical_ro$Covariate,
                               levels = c("X1, X2","X1, X2, X1\u00B2",
                                          "X1, X2, X2\u00B2","X1, X2, X1\u00B2, X2\u00B2"))

Identical_ro$Model<-factor(Identical_ro$Model,
                           levels = c("RS RM","RS AM 1","RS AM 2","RS AM 3",
                                      "OSMAC mMSE RM","OSMAC mMSE AM 1","OSMAC mMSE AM 2","OSMAC mMSE AM 3",
                                      "OSMAC mVc RM", "OSMAC mVc AM 1", "OSMAC mVc AM 2","OSMAC mVc AM 3",
                                      "OSMAC mMSE MF","OSMAC mVc MF"))

Selected_Models_mMSE<-c("RS RM","RS AM 1","RS AM 2","RS AM 3",
                        "OSMAC mMSE RM","OSMAC mMSE AM 1","OSMAC mMSE AM 2","OSMAC mMSE AM 3",
                        "OSMAC mMSE MF")

Colors_mMSE<-c("#FFC4D8", "#E28490","#BB2C3E","#55141C",
               "#88CCEE", "#A6C3D3","#5D92B0","#35586C", 
               "#DDCC77")

Selected_Models_mVc<-c("RS RM","RS AM 1","RS AM 2","RS AM 3",
                       "OSMAC mVc RM", "OSMAC mVc AM 1", "OSMAC mVc AM 2","OSMAC mVc AM 3",
                       "OSMAC mVc MF")

Colors_mVc<-Colors_mVc<-c("#FFC4D8","#E28490","#BB2C3E","#55141C", 
                          "#88CCEE","#A6C3D3","#5D92B0","#35586C", 
                          "#DDCC77")

Identical_ro[Identical_ro$Metric=="Model Information" & Identical_ro$Model %in% Selected_Models_mMSE,] %>%
  ggplot(.,aes(x=Subsample_Size,y=`Estimated Values`,color=Model))+
  scale_x_continuous(labels = unique(Identical_ro$Subsample_Size),
                     breaks = unique(Identical_ro$Subsample_Size))+
  geom_point(size=1.75)+geom_line(size=1)+scale_color_manual(values=Colors_mMSE)+
  facet_wrap(~Covariate,scales = "free_y",ncol = 4)+
  xlab("Sub-sample size")+ylab("Model Information")+
  theme_bw()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))->p1


Identical_ro[Identical_ro$Metric=="Model Information" & Identical_ro$Model %in% Selected_Models_mVc,] %>%
  ggplot(.,aes(x=Subsample_Size,y=`Estimated Values`,color=Model))+
  scale_x_continuous(labels = unique(Identical_ro$Subsample_Size),
                     breaks = unique(Identical_ro$Subsample_Size))+
  geom_point(size=1.75)+geom_line(size=1)+scale_color_manual(values=Colors_mVc)+
  facet_wrap(~Covariate,scales = "free_y",ncol = 4)+
  xlab("Sub-sample size")+ylab("Model Information")+
  theme_bw()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))->p2
  
Identical_ro[Identical_ro$Metric=="MSE" & Identical_ro$Model %in% Selected_Models_mMSE,] %>%
  ggplot(.,aes(x=Subsample_Size,y=`Estimated Values`,color=Model))+
  scale_x_continuous(labels = unique(Identical_ro$Subsample_Size),
                     breaks = unique(Identical_ro$Subsample_Size))+
  geom_point(size=1.75)+geom_line(size=1)+scale_color_manual(values=Colors_mMSE)+
  facet_wrap(~Covariate,scales = "free_y",ncol = 4)+
  xlab("Sub-sample size")+ylab("SMSE")+
  theme_bw()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))->p3


Identical_ro[Identical_ro$Metric=="MSE" & Identical_ro$Model %in% Selected_Models_mVc,] %>%
  ggplot(.,aes(x=Subsample_Size,y=`Estimated Values`,color=Model))+
  scale_x_continuous(labels = unique(Identical_ro$Subsample_Size),
                     breaks = unique(Identical_ro$Subsample_Size))+
  geom_point(size=1.75)+geom_line(size=1)+scale_color_manual(values=Colors_mVc)+
  facet_wrap(~Covariate,scales = "free_y",ncol = 4)+
  xlab("Sub-sample size")+ylab("SMSE")+
  theme_bw()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))->p4

ggarrange(p1,p3,nrow = 2,ncol = 1,common.legend = TRUE,legend = "right")
ggarrange(p2,p4,nrow = 2,ncol = 1,common.legend = TRUE,legend = "right")
```

