---
title: "Articles_Plots"
author: "Amalan"
date: '`r format(Sys.Date(), "%B %d, %Y")`'
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,fig.width = 14,fig.height = 16,message = FALSE,warning = FALSE)
library(here)
library(ggplot2)
library(dplyr)
library(tidyr)
library(LaplacesDemon)
library(xtable)
library(flextable)
library(grid)
library(cowplot)
library(linguisticsdown)
library(ggpubr)

```

# Using Uniform Distribution for Data

```{r Load data model 1}
load(here("Identical_r0","Generate_Big_Data","Model_1","No_Correlated_Covariate.RData"))
Model_1_SS<-r0

remove(Simulated_Data,Model_1,Nc_size,r0,Replicates,Subsample_Size,Model_Path)

# Random Sampling
load(here("Non_Identical_r0","Summary","Classical","Model_1","Data","Efficiency","No_Correlated_Covariate_RS.RData"))

Old_Labels<-c("Real Model",paste0("Assumed Model ",1:3))
New_Labels<-c("DM",paste0("AM ",1:3))

for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
  Accuracy_Data$Model[Accuracy_Data$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
}

RS_Info<-All_Info
RS_MSE<-All_MSE
RS_ACC<-Accuracy_Data

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR,Accuracy_Data)

# OSMAC
load(here("Identical_r0","Summary","Classical","Model_1","Data","Efficiency","No_Correlated_Covariate_OSMAC.RData"))
remove_stuff<-c(paste0("Assumed New ",1:3))
All_MSE<-All_MSE[!(All_MSE$Model %in% remove_stuff),]
All_Info<-All_Info[!(All_Info$Model %in% remove_stuff),]
All_ACC<-Accuracy_Data[!(Accuracy_Data$Model %in% remove_stuff),]

Old_Labels<-c("Real",paste0("Assumed Old ",1:3),"Model Free")
New_Labels<-c("DM",paste0("AM ",1:3),"MR")

## mMSE
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mMSE"] <-paste0("mMSE ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mMSE"] <-paste0("mMSE ",New_Labels[i])
  All_ACC$Model[All_ACC$Model==Old_Labels[i] & All_ACC$Type == "mMSE"] <-paste0("mMSE ",New_Labels[i])
}

## mVc
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mVc"] <-paste0("mVc ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mVc"] <-paste0("mVc ",New_Labels[i])
  All_ACC$Model[All_ACC$Model==Old_Labels[i] & All_ACC$Type == "mVc"] <-paste0("mVc ",New_Labels[i])
}

OSMAC_Info<-All_Info
OSMAC_MSE<-All_MSE
OSMAC_ACC<-All_ACC

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR,Accuracy_Data)

# All elements
All_MSE<-rbind(RS_MSE,OSMAC_MSE[,!(colnames(OSMAC_MSE) %in% "Type")])
All_Info<-rbind(RS_Info,OSMAC_Info[,!(colnames(OSMAC_Info) %in% "Type")])
All_ACC<-rbind(RS_ACC,OSMAC_ACC[,!(colnames(OSMAC_ACC) %in% "Type")])

All_Objects<-ls()
remove(list = All_Objects[startsWith(All_Objects,"OSMAC")])

colnames(All_Info)[3]<-"Estimated Values"
colnames(All_MSE)[3]<-"Estimated Values"
colnames(All_ACC)[3]<-"Estimated Values"

M1_Identical_r0<-rbind(cbind.data.frame(Covariate="Data Model: x\u2081, x\u2082",Metric="Model Information",
                                        All_Info),
                       cbind.data.frame(Covariate="Data Model: x\u2081, x\u2082",Metric="MSE",
                                        All_MSE),
                       cbind.data.frame(Covariate="Data Model: x\u2081, x\u2082",Metric="Average MSE Y",
                                        All_ACC))

remove(All_Info,All_MSE,RS_Info,RS_MSE,All_ACC)

M1_Identical_r0$Subsample_Size<-M1_Identical_r0$Subsample_Size-Model_1_SS
```

```{r Load data model 2}
load(here("Identical_r0","Generate_Big_Data","Model_2","No_Correlated_Covariate.RData"))
Model_2_SS<-r0

remove(Simulated_Data,Model_2,Nc_size,r0,Replicates,Subsample_Size,Model_Path)

# Random Sampling
load(here("Non_Identical_r0","Summary","Classical","Model_2","Data","Efficiency","No_Correlated_Covariate_RS.RData"))

Old_Labels<-c("Real Model",paste0("Assumed Model ",1:3))
New_Labels<-c("DM",paste0("AM ",1:3))

for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
  Accuracy_Data$Model[Accuracy_Data$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
}

RS_Info<-All_Info
RS_MSE<-All_MSE
RS_ACC<-Accuracy_Data

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR,Accuracy_Data)

# OSMAC
load(here("Identical_r0","Summary","Classical","Model_2","Data","Efficiency","No_Correlated_Covariate_OSMAC.RData"))
remove_stuff<-c(paste0("Assumed New ",1:3))
All_MSE<-All_MSE[!(All_MSE$Model %in% remove_stuff),]
All_Info<-All_Info[!(All_Info$Model %in% remove_stuff),]
Accuracy_Data<-Accuracy_Data[!(Accuracy_Data$Model %in% remove_stuff),]

Old_Labels<-c("Real",paste0("Assumed Old ",1:3),"Model Free")
New_Labels<-c("DM",paste0("AM ",1:3),"MR")

## mMSE
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mMSE"] <-paste0("mMSE ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mMSE"] <-paste0("mMSE ",New_Labels[i])
  Accuracy_Data$Model[Accuracy_Data$Model==Old_Labels[i] & Accuracy_Data$Type == "mMSE"] <-paste0("mMSE ",New_Labels[i])
}

## mVc
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mVc"] <-paste0("mVc ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mVc"] <-paste0("mVc ",New_Labels[i])
  Accuracy_Data$Model[Accuracy_Data$Model==Old_Labels[i] & Accuracy_Data$Type == "mVc"] <-paste0("mVc ",New_Labels[i])
}

OSMAC_Info<-All_Info
OSMAC_MSE<-All_MSE
OSMAC_ACC<-Accuracy_Data

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR,Accuracy_Data)

# All elements
All_MSE<-rbind(RS_MSE,OSMAC_MSE[,!(colnames(OSMAC_MSE) %in% "Type")])
All_Info<-rbind(RS_Info,OSMAC_Info[,!(colnames(OSMAC_Info) %in% "Type")])
All_ACC<-rbind(RS_ACC,OSMAC_ACC[,!(colnames(OSMAC_ACC) %in% "Type")])

All_Objects<-ls()
remove(list = All_Objects[startsWith(All_Objects,"OSMAC")])

colnames(All_Info)[3]<-"Estimated Values"
colnames(All_MSE)[3]<-"Estimated Values"
colnames(All_ACC)[3]<-"Estimated Values"

M2_Identical_r0<-rbind(cbind.data.frame(Covariate="Data Model: x\u2081, x\u2082, (x\u2081)\u00B2",Metric="Model Information",
                                        All_Info),
                       cbind.data.frame(Covariate="Data Model: x\u2081, x\u2082, (x\u2081)\u00B2",Metric="MSE",
                                        All_MSE),
                       cbind.data.frame(Covariate="Data Model: x\u2081, x\u2082, (x\u2081)\u00B2",Metric="Average MSE Y",
                                        All_ACC))

remove(All_Info,All_MSE,RS_Info,RS_MSE,All_ACC)

M2_Identical_r0$Subsample_Size<-M2_Identical_r0$Subsample_Size-Model_2_SS
```

```{r Load data model 3}
load(here("Identical_r0","Generate_Big_Data","Model_3","No_Correlated_Covariate.RData"))
Model_3_SS<-r0

remove(Simulated_Data,Model_3,Nc_size,r0,Replicates,Subsample_Size,Model_Path)

# Random Sampling
load(here("Non_Identical_r0","Summary","Classical","Model_3","Data","Efficiency","No_Correlated_Covariate_RS.RData"))

Old_Labels<-c("Real Model",paste0("Assumed Model ",1:3))
New_Labels<-c("DM",paste0("AM ",1:3))

for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
  Accuracy_Data$Model[Accuracy_Data$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
}

RS_Info<-All_Info
RS_MSE<-All_MSE
RS_ACC<-Accuracy_Data

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR,Accuracy_Data)

# OSMAC
load(here("Identical_r0","Summary","Classical","Model_3","Data","Efficiency","No_Correlated_Covariate_OSMAC.RData"))
remove_stuff<-c(paste0("Assumed New ",1:3))
All_MSE<-All_MSE[!(All_MSE$Model %in% remove_stuff),]
All_Info<-All_Info[!(All_Info$Model %in% remove_stuff),]
All_ACC<-Accuracy_Data[!(Accuracy_Data$Model %in% remove_stuff),]

Old_Labels<-c("Real",paste0("Assumed Old ",1:3),"Model Free")
New_Labels<-c("DM",paste0("AM ",1:3),"MR")

## mMSE
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mMSE"] <-paste0("mMSE ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mMSE"] <-paste0("mMSE ",New_Labels[i])
  All_ACC$Model[All_ACC$Model==Old_Labels[i] & All_ACC$Type == "mMSE"] <-paste0("mMSE ",New_Labels[i])
}

## mVc
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mVc"] <-paste0("mVc ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mVc"] <-paste0("mVc ",New_Labels[i])
  All_ACC$Model[All_ACC$Model==Old_Labels[i] & All_ACC$Type == "mVc"] <-paste0("mVc ",New_Labels[i])
}

OSMAC_Info<-All_Info
OSMAC_MSE<-All_MSE
OSMAC_ACC<-All_ACC

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR,All_ACC)

# All elements
All_MSE<-rbind(RS_MSE,OSMAC_MSE[,!(colnames(OSMAC_MSE) %in% "Type")])
All_Info<-rbind(RS_Info,OSMAC_Info[,!(colnames(OSMAC_Info) %in% "Type")])
All_ACC<-rbind(RS_ACC,OSMAC_ACC[,!(colnames(OSMAC_ACC) %in% "Type")])

All_Objects<-ls()
remove(list = All_Objects[startsWith(All_Objects,"OSMAC")])

colnames(All_Info)[3]<-"Estimated Values"
colnames(All_MSE)[3]<-"Estimated Values"
colnames(All_ACC)[3]<-"Estimated Values"

M3_Identical_r0<-rbind(cbind.data.frame(Covariate="Data Model: x\u2081, x\u2082, (x\u2082)\u00B2",Metric="Model Information",
                                        All_Info),
                       cbind.data.frame(Covariate="Data Model: x\u2081, x\u2082, (x\u2082)\u00B2",Metric="MSE",
                                        All_MSE),
                       cbind.data.frame(Covariate="Data Model: x\u2081, x\u2082, (x\u2082)\u00B2",Metric="Average MSE Y",
                                        All_ACC))

remove(All_Info,All_MSE,RS_Info,RS_MSE)

M3_Identical_r0$Subsample_Size<-M3_Identical_r0$Subsample_Size-Model_3_SS
```

```{r Load data model 4}
load(here("Identical_r0","Generate_Big_Data","Model_4","No_Correlated_Covariate.RData"))
Model_4_SS<-r0

remove(Simulated_Data,Model_4,Nc_size,r0,Replicates,Subsample_Size,Model_Path)

# Random Sampling
load(here("Non_Identical_r0","Summary","Classical","Model_4","Data","Efficiency","No_Correlated_Covariate_RS.RData"))

Old_Labels<-c("Real Model",paste0("Assumed Model ",1:3))
New_Labels<-c("DM",paste0("AM ",1:3))

for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
  Accuracy_Data$Model[Accuracy_Data$Model==Old_Labels[i]] <-paste0("RS ",New_Labels[i])
}

RS_Info<-All_Info
RS_MSE<-All_MSE
RS_ACC<-Accuracy_Data

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR,Accuracy_Data)

# OSMAC
load(here("Identical_r0","Summary","Classical","Model_4","Data","Efficiency","No_Correlated_Covariate_OSMAC.RData"))
remove_stuff<-c(paste0("Assumed New ",1:3))
All_MSE<-All_MSE[!(All_MSE$Model %in% remove_stuff),]
All_Info<-All_Info[!(All_Info$Model %in% remove_stuff),]
All_ACC<-Accuracy_Data[!(Accuracy_Data$Model %in% remove_stuff),]

Old_Labels<-c("Real",paste0("Assumed Old ",1:3),"Model Free")
New_Labels<-c("DM",paste0("AM ",1:3),"MR")

## mMSE
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mMSE"] <-paste0("mMSE ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mMSE"] <-paste0("mMSE ",New_Labels[i])
  All_ACC$Model[All_ACC$Model==Old_Labels[i] & All_ACC$Type == "mMSE"] <-paste0("mMSE ",New_Labels[i])
}

## mVc
for (i in 1:length(Old_Labels)) 
{
  All_Info$Model[All_Info$Model==Old_Labels[i] & All_Info$Type == "mVc"] <-paste0("mVc ",New_Labels[i])
  All_MSE$Model[All_MSE$Model==Old_Labels[i] & All_MSE$Type == "mVc"] <-paste0("mVc ",New_Labels[i])
  All_ACC$Model[All_ACC$Model==Old_Labels[i] & All_ACC$Type == "mVc"] <-paste0("mVc ",New_Labels[i])
}

OSMAC_Info<-All_Info
OSMAC_MSE<-All_MSE
OSMAC_ACC<-All_ACC

remove(All_Bias,All_EMSE,All_MSE,All_Info,All_VAR,All_ACC)

# All elements
All_MSE<-rbind(RS_MSE,OSMAC_MSE[,!(colnames(OSMAC_MSE) %in% "Type")])
All_Info<-rbind(RS_Info,OSMAC_Info[,!(colnames(OSMAC_Info) %in% "Type")])
All_ACC<-rbind(RS_ACC,OSMAC_ACC[,!(colnames(OSMAC_ACC) %in% "Type")])

All_Objects<-ls()
remove(list = All_Objects[startsWith(All_Objects,"OSMAC")])

colnames(All_Info)[3]<-"Estimated Values"
colnames(All_MSE)[3]<-"Estimated Values"
colnames(All_ACC)[3]<-"Estimated Values"

M4_Identical_r0<-rbind(cbind.data.frame(Covariate="Data Model: x\u2081, x\u2082, (x\u2081)\u00B2, (x\u2082)\u00B2",
                                        Metric="Model Information",All_Info),
                       cbind.data.frame(Covariate="Data Model: x\u2081, x\u2082, (x\u2081)\u00B2, (x\u2082)\u00B2",
                                        Metric="MSE",All_MSE),
                       cbind.data.frame(Covariate="Data Model: x\u2081, x\u2082, (x\u2081)\u00B2, (x\u2082)\u00B2",
                                        Metric="Average MSE Y",All_ACC))

remove(All_Info,All_MSE,RS_Info,RS_MSE,RS_ACC)

M4_Identical_r0$Subsample_Size<-M4_Identical_r0$Subsample_Size-Model_4_SS
```

```{r combine data and plot,fig.width = 8,fig.height = 12}
Identical_ro<-rbind(M1_Identical_r0,M2_Identical_r0,
                    M3_Identical_r0,M4_Identical_r0)

Identical_ro$Covariate<-factor(Identical_ro$Covariate,
                               levels = c("Data Model: x\u2081, x\u2082",
                                          "Data Model: x\u2081, x\u2082, (x\u2081)\u00B2",
                                          "Data Model: x\u2081, x\u2082, (x\u2082)\u00B2",
                                          "Data Model: x\u2081, x\u2082, (x\u2081)\u00B2, (x\u2082)\u00B2"))

Identical_ro$Model<-factor(Identical_ro$Model,
                           levels = c("RS DM","RS AM 1","RS AM 2","RS AM 3",
                                      "mMSE DM","mMSE AM 1","mMSE AM 2","mMSE AM 3",
                                      "mVc DM","mVc AM 1","mVc AM 2","mVc AM 3",
                                      "mMSE MR","mVc MR"))

Identical_ro$Model<-recode_factor(Identical_ro$Model,
                                  `RS DM`="Random Sampling: Data Model",
                                  `RS AM 1`="Random Sampling: Incorrect Model 1",
                                  `RS AM 2`="Random Sampling: Incorrect Model 2",
                                  `RS AM 3`="Random Sampling: Incorrect Model 3",
                                  `mMSE DM`="Optimal Sub-sampling mMSE: Data Model",
                                  `mMSE AM 1`="Optimal Sub-sampling mMSE: Incorrect Model 1",
                                  `mMSE AM 2`="Optimal Sub-sampling mMSE: Incorrect Model 2",
                                  `mMSE AM 3`="Optimal Sub-sampling mMSE: Incorrect Model 3",
                                  `mVc DM`="Optimal Sub-sampling mVc: Data Model",
                                  `mVc AM 1`="Optimal Sub-sampling mVc: Incorrect Model 1",
                                  `mVc AM 2`="Optimal Sub-sampling mVc: Incorrect Model 2",
                                  `mVc AM 3`="Optimal Sub-sampling mVc: Incorrect Model 3",
                                  `mMSE MR`="Model Robust Optimal Sub-sampling mMSE: Data Model",
                                  `mVc MR`="Model Robust Optimal Sub-sampling mVc: Data Model")

Selected_Models_mMSE<-c("Random Sampling: Data Model",
                        #"Random Sampling: Incorrect Model 1",
                        #"Random Sampling: Incorrect Model 2",
                        #"Random Sampling: Incorrect Model 3",
                        "Optimal Sub-sampling mMSE: Data Model",
                        "Optimal Sub-sampling mMSE: Incorrect Model 1",
                        "Optimal Sub-sampling mMSE: Incorrect Model 2",
                        "Optimal Sub-sampling mMSE: Incorrect Model 3",
                        "Model Robust Optimal Sub-sampling mMSE: Data Model")

# Colors_mMSE<-c("#88CCEE", #"#A6C3D3","#5D92B0","#35586C", 
#                "#FFC4D8","#E28490","#BB2C3E","#55141C",
#                "#DDCC77")

Colors_mMSE<-c("black",#"grey","grey","grey",
              "#cc0000", 
              "#ff578a","#ff578a","#ff578a",
              "darkgreen")

Selected_Models_mVc<-c("Random Sampling: Data Model",
                       #"Random Sampling: Incorrect Model 1",
                       #"Random Sampling: Incorrect Model 2",
                       #"Random Sampling: Incorrect Model 3",
                       "Optimal Sub-sampling mVc: Data Model",
                       "Optimal Sub-sampling mVc: Incorrect Model 1",
                       "Optimal Sub-sampling mVc: Incorrect Model 2",
                       "Optimal Sub-sampling mVc: Incorrect Model 3",
                       "Model Robust Optimal Sub-sampling mVc: Data Model")

# Colors_mVc<-Colors_mVc<-c("#88CCEE",#"#A6C3D3","#5D92B0","#35586C", 
#                           "#FFC4D8","#E28490","#BB2C3E","#55141C", 
#                           "#DDCC77")

Colors_mVc<-c("black",#"grey","grey","grey",
              "#cc0000", 
              "#ff578a","#ff578a","#ff578a",
              "darkgreen")

Theme_special<-function()
{
  theme(axis.text.x = element_text(color = "black",size=12, angle = 45, hjust=0.75), #, vjust = 0.5
        axis.text.y = element_text(color = "black",size=12), #, vjust = 0.5, hjust=1
        strip.text = element_text(colour = "black",size = 12,face="bold"),
        panel.grid.minor.x = element_blank(),
        axis.title= element_text(color = "black",face = "bold",size = 12),
        legend.text = element_text(color = "black", size=11),
        legend.position = "bottom",
        legend.margin=margin(0,0,0,0),
        legend.box.margin=margin(-1,-2,-1,-2)) 
}

#Identical_ro<-Identical_ro[Identical_ro$Subsample_Size %in% seq(100,1000,100),]

Identical_ro[Identical_ro$Metric=="Model Information" & Identical_ro$Model %in% Selected_Models_mMSE,] %>%
  ggplot(.,aes(x=Subsample_Size,y=`Estimated Values`,color=Model))+
  scale_x_continuous(labels = unique(Identical_ro$Subsample_Size),
                     breaks = unique(Identical_ro$Subsample_Size))+
  geom_point(size=1.75)+geom_line(size=1)+
  scale_color_manual(values=Colors_mMSE)+
  facet_wrap(~Covariate,scales = "free_y",ncol = 4)+
  xlab("r")+
  ylab("Average Model Information")+expand_limits(y = 0)+
  scale_y_continuous(breaks = scales::pretty_breaks(n = length(unique(Identical_ro$Subsample_Size))/2))+
  theme_bw()+guides(colour = guide_legend(nrow = 2))+Theme_special()->Temp_plot_mMSE

Temp_legend_mMSE<-get_legend(Temp_plot_mMSE)

Identical_ro[Identical_ro$Metric=="Model Information" & Identical_ro$Model %in% Selected_Models_mVc,] %>%
  ggplot(.,aes(x=Subsample_Size,y=`Estimated Values`,color=Model))+
  scale_x_continuous(labels = unique(Identical_ro$Subsample_Size),
                     breaks = unique(Identical_ro$Subsample_Size))+
  geom_point(size=1.75)+geom_line(size=1)+
  scale_color_manual(values=Colors_mMSE)+
  facet_wrap(~Covariate,scales = "free_y",ncol = 4)+
  xlab("r")+
  ylab("Average Model Information")+expand_limits(y = 0)+
  scale_y_continuous(breaks = scales::pretty_breaks(n = length(unique(Identical_ro$Subsample_Size))/2))+
  theme_bw()+guides(colour = guide_legend(nrow = 2))+Theme_special()->Temp_plot_mVc

Temp_legend_mVc<-get_legend(Temp_plot_mVc)

Identical_ro[Identical_ro$Metric=="Model Information" & Identical_ro$Model %in% Selected_Models_mMSE,] %>%
  ggplot(.,aes(x=Subsample_Size,y=log(`Estimated Values`),color=Model))+
  scale_x_continuous(labels = unique(Identical_ro$Subsample_Size),
                     breaks = unique(Identical_ro$Subsample_Size))+
  geom_point(size=1.75)+geom_line(size=1)+
  scale_color_manual(values=Colors_mMSE)+
  facet_wrap(~Covariate,scales = "free_y",ncol = 2)+
  xlab("r")+
  ylab("log(Average Model Information)")+#expand_limits(y = 0)+
  scale_y_continuous(breaks = scales::pretty_breaks(n = length(unique(Identical_ro$Subsample_Size))/2))+
  theme_bw()+Theme_special()->p1

Identical_ro[Identical_ro$Metric=="Model Information" & Identical_ro$Model %in% Selected_Models_mVc,] %>%
  ggplot(.,aes(x=Subsample_Size,y=log(`Estimated Values`),color=Model))+
  scale_x_continuous(labels = unique(Identical_ro$Subsample_Size),
                     breaks = unique(Identical_ro$Subsample_Size))+
  geom_point(size=1.75)+geom_line(size=1)+
  scale_color_manual(values=Colors_mVc)+
  facet_wrap(~Covariate,scales = "free_y",ncol = 2)+
  xlab("r")+
  ylab("log(Average Model Information)")+#expand_limits(y = 0)+
  scale_y_continuous(breaks = scales::pretty_breaks(n = length(unique(Identical_ro$Subsample_Size))/2))+
  theme_bw()+Theme_special()->p2
  
Identical_ro[Identical_ro$Metric=="MSE" & Identical_ro$Model %in% Selected_Models_mMSE,] %>%
  ggplot(.,aes(x=Subsample_Size,y=log(`Estimated Values`),color=Model))+
  scale_x_continuous(labels = unique(Identical_ro$Subsample_Size),
                     breaks = unique(Identical_ro$Subsample_Size))+
  geom_point(size=1.75)+geom_line(size=1)+
  scale_color_manual(values=Colors_mMSE)+
  facet_wrap(~Covariate,scales = "free_y",ncol = 2)+
  xlab("r")+
  ylab("log(SMSE)")+#expand_limits(y = 0)+
  scale_y_continuous(breaks = scales::pretty_breaks(n = length(unique(Identical_ro$Subsample_Size))/2))+
  theme_bw()+Theme_special()->p3


Identical_ro[Identical_ro$Metric=="MSE" & Identical_ro$Model %in% Selected_Models_mVc,] %>%
  ggplot(.,aes(x=Subsample_Size,y=log(`Estimated Values`),color=Model))+
  scale_x_continuous(labels = unique(Identical_ro$Subsample_Size),
                     breaks = unique(Identical_ro$Subsample_Size))+
  geom_point(size=1.75)+geom_line(size=1)+
  scale_color_manual(values=Colors_mVc)+
  facet_wrap(~Covariate,scales = "free_y",ncol = 2)+
  xlab("r")+
  ylab("log(SMSE)")+#expand_limits(y = 0)+
  scale_y_continuous(breaks = scales::pretty_breaks(n = length(unique(Identical_ro$Subsample_Size))/2))+
  theme_bw()+Theme_special()->p4

Identical_ro[Identical_ro$Metric=="Average MSE Y" & Identical_ro$Model %in% Selected_Models_mMSE,] %>%
  ggplot(.,aes(x=Subsample_Size,y=log(`Estimated Values`),color=Model))+
  scale_x_continuous(labels = unique(Identical_ro$Subsample_Size),
                     breaks = unique(Identical_ro$Subsample_Size))+
  geom_point(size=1.75)+geom_line(size=1)+
  scale_color_manual(values=Colors_mMSE)+
  facet_wrap(~Covariate,scales = "free_y",ncol = 2)+
  xlab("r")+
  ylab("log(Average MSE of Y)")+#expand_limits(y = 0)+
  scale_y_continuous(breaks = scales::pretty_breaks(n = length(unique(Identical_ro$Subsample_Size))/2))+
  theme_bw()+Theme_special()->p5


Identical_ro[Identical_ro$Metric=="Average MSE Y" & Identical_ro$Model %in% Selected_Models_mVc,] %>%
  ggplot(.,aes(x=Subsample_Size,y=log(`Estimated Values`),color=Model))+
  scale_x_continuous(labels = unique(Identical_ro$Subsample_Size),
                     breaks = unique(Identical_ro$Subsample_Size))+
  geom_point(size=1.75)+geom_line(size=1)+
  scale_color_manual(values=Colors_mVc)+
  facet_wrap(~Covariate,scales = "free_y",ncol = 2)+
  xlab("r")+
  ylab("log(Average MSE of Y)")+#expand_limits(y = 0)+
  scale_y_continuous(breaks = scales::pretty_breaks(n = length(unique(Identical_ro$Subsample_Size))/2))+
  theme_bw()+Theme_special()->p6

ggarrange(p1,p3,nrow = 2,ncol = 1,legend.grob = Temp_legend_mMSE,legend = "bottom",labels = "auto")
ggarrange(p2,p4,nrow = 2,ncol = 1,legend.grob = Temp_legend_mVc,legend = "bottom",labels = "auto")
ggarrange(p5,nrow = 1,ncol = 1,legend.grob = Temp_legend_mMSE,legend = "bottom")
ggarrange(p6,nrow = 1,ncol = 1,legend.grob = Temp_legend_mVc,legend = "bottom")

ggarrange(p1,p3,nrow = 2,ncol = 1,legend.grob = Temp_legend_mMSE,legend = "bottom",labels = "auto") %>%
  ggexport(filename = "SMSE_MI_PR_TV_Uni_mMSE.pdf",res=300,width = 12,height = 16)
ggarrange(p2,p4,nrow = 2,ncol = 1,legend.grob = Temp_legend_mVc,legend = "bottom",labels = "auto") %>% 
  ggexport(filename = "SMSE_MI_PR_TV_Uni_mVc.pdf",res=300,width = 12,height = 16)
ggarrange(p5,nrow = 1,ncol = 1,legend.grob = Temp_legend_mMSE,legend = "bottom") %>%
  ggexport(filename = "ACCURACY_PR_TV_Uni_mMSE.pdf",res=300,width = 12,height = 12)
ggarrange(p6,nrow = 1,ncol = 1,legend.grob = Temp_legend_mVc,legend = "bottom") %>%
  ggexport(filename = "ACCURACY_PR_TV_Uni_mVc.pdf",res=300,width = 12,height = 12)
```

